<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style/main.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <title>Twiddler - ttreit</title>
  </head>
  <body>
    <script>
      $(document).ready(function(){


        //var $body = $('body');
        // $body.html('');  -- given, not sure what it's for but was told it causes problems.

        let msgHistory = {};

        function getTweets() {
          var index = streams.home.length - 1;
        while(index >= 0){
          var tweet = streams.home[index];
          var $tweet = $('<div></div>');
          //add time stamp here
          let today = new Date();
          let date = (today.getMonth()+1)+'/'+today.getDate()+'/' + today.getFullYear();
          let time = today.getHours() + ":" + today.getMinutes();
          let dateTime = '  --- sent on: ' + date+' at: '+time;

          let linkUser = tweet.user;

          //what do we know?
          //onclick run getHistory
          //need to understand appendTo()
          //getHistory requires i send it linkUser which must be tweet.user
          //formatting should happen in tweet.text
          //use anchor text to wrap linkUser (variable probably not needed) and onclick fire off the function.
          //the function should take care of everything else.
          //<a href="javascript:someFunction()">LINK</a>



          $tweet.text('@' + linkUser + ': ' + tweet.message + dateTime );
          $tweet.appendTo('.feed');
          if(!(msgHistory.hasOwnProperty(tweet.user))) {
            msgHistory[tweet.user] = [`${tweet.message} --- sent on: ${date} at: ${time}`];
          } else {
            msgHistory[tweet.user].push(`${tweet.message} --- sent on: ${date} at: ${time}`);
          }
          console.log(msgHistory);
          index -= 1;
          }
        }


        function getHistory(user) {
          let arrayToProcess = msgHistory[user];
          for (i = 0; i < arrayToProcess.length; i++) {
            arrayToProcess[i].appendTo('.history');
          }

        }

        function helloWorld() {
          let hw = "Hello World";
          console.log('Hello World');
          return hw;

        }



      //main
        getTweets();
        setInterval( getTweets, 1000000);


      });




    </script>



<div class="grid">
  <div class="title">
    <h1>Twiddler!</h1>
  </div>
  <div class="feed">
    <h2>Feed</h2>
  </div>
  <div class="history">
    <h2>History</h2>
    <p id=list-history>

    </p>
  </div>
</div>
  </body>
</html>
